#!/bin/bash
# This is a simple script and will be executed on your CI system if 
# available.  Otherwise it will execute while your application is stopped
# before the build step.  This script gets executed directly, so it
# could be python, php, ruby, etc.

set -e

cd ~/app-root/runtime/

# create dir to put all our stuff
mkdir -p couchdb
cd couchdb

# get spidermonkey
wget ftp://ftp.univie.ac.at/systems/linux/fedora/releases/17/Everything/x86_64/os/Packages/j/js-devel-1.8.5-9.fc17.x86_64.rpm
wget ftp://ftp.univie.ac.at/systems/linux/fedora/releases/17/Fedora/x86_64/os/Packages/j/js-1.8.5-9.fc17.x86_64.rpm

# get erlang
wget http://www.erlang.org/download/otp_src_R15B03-1.tar.gz
# get couchdb
wget http://artfiles.org/apache.org/couchdb/1.2.1/apache-couchdb-1.2.1.tar.gz
# get ICU
wget http://download.icu-project.org/files/icu4c/4.8.1.1/icu4c-4_8_1_1-RHEL6-x64.tgz

# unpack all
rpm2cpio js-devel-1.8.5-9.fc17.x86_64.rpm | cpio -id 
rpm2cpio js-1.8.5-9.fc17.x86_64.rpm | cpio -id 

tar -xzf otp_src_R15B03-1.tar.gz
tar -xzf apache-couchdb-1.2.1.tar.gz
tar -xzf icu4c-4_8_1_1-RHEL6-x64.tgz

# remove to avoid hiting the quota
rm *.rpm *.tar.gz *.tgz

